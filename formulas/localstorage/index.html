<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
    <meta charset='utf-8'>
    <title>Using Local Storage | Formulas | Learn Ionic</title>
    <link href='/css/site.css' rel='stylesheet'>
    <link href='//cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.0/animate.min.css' rel='stylesheet'>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-44023830-6', 'ionicframework.com');
      ga('send', 'pageview');
    </script>
  </head>
  <body class='full-page no-js'>
    <script>
      document.body.classList.remove('no-js');
    </script>
    <div class='container'>
      <div class='row'>
        <div class='side-nav'>
          <div class='logo'>
            <a href='/'>
              <img alt='Learn Ionic Framework' height='43' src='/img/learn-ionicframework@2x.png' width='194'>
            </a>
          </div>
          <nav>
            <ul>
              <li>
                <a href='/videos/'>
                  <i class='ion-videos'></i>
                  <p>Videos</p>
                </a>
              </li>
              <li>
                <a class='active' href='/formulas/'>
                  <i class='ion-formulas'></i>
                  <p>Formulas</p>
                </a>
              </li>
              <li>
                <a href='/resources/'>
                  <i class='ion-resources'></i>
                  <p>Resources</p>
                </a>
              </li>
            </ul>
            <footer>
              <ul>
                <li>
                  <a href='https://github.com/driftyco/ionic-learn/issues/new' target='_new'>
                    <i class='ion-suggestions'></i>
                    <p>Suggest a Topic</p>
                  </a>
                </li>
                <li>
                  <a href='http://forum.ionicframework.com/' target='_new'>
                    <i class='ion-forum'></i>
                    <p>Forums</p>
                  </a>
                </li>
                <li>
                  <a href='https://github.com/driftyco/ionic' target='_new'>
                    <i class='ion-github'></i>
                    <p>Github</p>
                  </a>
                </li>
                <li>
                  <a href='https://twitter.com/ionicframework' target='_new'>
                    <i class='ion-twitter'></i>
                    <p>Twitter</p>
                  </a>
                </li>
                <li>
                  <a href='https://plus.google.com/+Ionicframework/posts' target='_new'>
                    <i class='ion-googleplus'></i>
                    <p>Plus</p>
                  </a>
                </li>
              </ul>
            </footer>
          </nav>
        </div>
        <div class='main-pane'>
          <div class='content formula'>
            <nav>
              <a class='left' href='/formulas/'>
                <i class='ion-chevron-left'></i>
                <span style='margin-left:-5px;'>All Formulas</span>
              </a>
            </nav>
            <article>
              <header>
                <h1>Using Local Storage</h1>
                <div class='byline'>
                  <img src='/img/authors/max-lynch.png'>
                  <span class='author'>
                    Written by
                    <a href='https://twitter.com/maxlynch' target='_new'>Max Lynch</a>
                  </span>
                  <time></time>
                </div>
              </header>
              <p>Being able to persist data locally in an app is crucial. The large variance in mobile network connectivity and the fact that users expect apps to reasonably function regardless of whether they are connected to the web or not means we need to make sure we store enough data locally to make the app function in these conditions.</p>
              
              <p>Fortunately, with web technologies storing data locally is fast and easy.</p>
              
              <h3 id="local-storage">Local Storage</h3>
              
              <p>Browsers provide a convenient module for storing data in a simple key &lt;-&gt; value fashion called <code>localStorage</code>. This is an object on <code>window</code> that we can get and set String values easily with:</p>
              
              <div><div class="CodeRay">
                <div class="code"><pre>window.localStorage[<span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>] = <span class="string"><span class="delimiter">'</span><span class="content">Max</span><span class="delimiter">'</span></span>;&#x000A;&#x000A;<span class="keyword">var</span> name = window.localStorage[<span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>] || <span class="string"><span class="delimiter">'</span><span class="content">you</span><span class="delimiter">'</span></span>;&#x000A;alert(<span class="string"><span class="delimiter">'</span><span class="content">Hello, </span><span class="delimiter">'</span></span> + name);</pre></div>
              </div>
              </div>
              
              <p>In this example, we set the <code>'name'</code> key to have the value <code>'Max'</code>. When we grab the value back using <code>localStorage['name']</code> we add a fallback return value of <code>'you'</code> in case the key doesn’t have a value stored for it (just to be safe).</p>
              
              <p>In localStorage, we can only set String values. But we’ll see soon that this isn’t much of a problem.</p>
              
              <h3 id="storing-objects">Storing Objects</h3>
              
              <p>Since we can only store Strings in localStorage, how would we store objects? Well, we just have to convert them to JSON first!</p>
              
              <div><div class="CodeRay">
                <div class="code"><pre><span class="keyword">var</span> post = {&#x000A;  <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">Thoughts</span><span class="delimiter">'</span></span>,&#x000A;  <span class="key">text</span>: <span class="string"><span class="delimiter">'</span><span class="content">Today was a good day</span><span class="delimiter">'</span></span>&#x000A;};&#x000A;&#x000A;window.localStorage[<span class="string"><span class="delimiter">'</span><span class="content">post</span><span class="delimiter">'</span></span>] = JSON.stringify(post);&#x000A;&#x000A;<span class="keyword">var</span> post = JSON.parse(window.localStorage[<span class="string"><span class="delimiter">'</span><span class="content">post</span><span class="delimiter">'</span></span>] || <span class="string"><span class="delimiter">'</span><span class="content">{}</span><span class="delimiter">'</span></span>);</pre></div>
              </div>
              </div>
              
              <p>the <code>post</code> variable will now contain the full object. The same can be done for arrays or any other object!</p>
              
              <h3 id="icloud-backup">iCloud Backup</h3>
              
              <p>When using <code>localStorage</code> in a mobile app that you intend to deploy to the Apple App Store, you must take into account iCloud storage and the iOS Data Storage Guidelines which suggest, among other things, that only data the user <em>creates</em> should be backed up to iCloud.</p>
              
              <p>To make sure data stored in <code>localStorage</code> does not get backed up to iCloud and thus resulting in Apple rejecting your app for voilating the Data Storage Guidelines, make sure to set <code>BackupWebStorage</code> to <code>none</code> in your <code>config.xml</code> for Cordova/PhoneGap:</p>
              
              <div><div class="CodeRay">
                <div class="code"><pre><span class="comment">&lt;!-- config.xml --&gt;</span>&#x000A;&#x000A;<span class="preprocessor">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span>&#x000A;<span class="tag">&lt;widget</span> <span class="attribute-name">...</span><span class="tag">&gt;</span>&#x000A;  <span class="tag">&lt;preference</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">BackupWebStorage</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">none</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>&#x000A;<span class="tag">&lt;/widget&gt;</span></pre></div>
              </div>
              </div>
              
              <h3 id="angularjs-service">AngularJS Service</h3>
              
              <p>Using <code>window.localStorage</code> directly is just fine, but having to set and parse Strings gets tiresome after a while. Use this simple AngularJS service for setting and retrieving strings or objects easily:</p>
              
              <div><div class="CodeRay">
                <div class="code"><pre>angular.module(<span class="string"><span class="delimiter">'</span><span class="content">ionic.utils</span><span class="delimiter">'</span></span>, [])&#x000A;&#x000A;.factory(<span class="string"><span class="delimiter">'</span><span class="content">localstorage</span><span class="delimiter">'</span></span>, [<span class="string"><span class="delimiter">'</span><span class="content">$window</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>(<span class="predefined">$window</span>) {&#x000A;  <span class="keyword">return</span> {&#x000A;    <span class="function">set</span>: <span class="keyword">function</span>(key, value) {&#x000A;      <span class="predefined">$window</span>.localStorage[key] = value;&#x000A;    },&#x000A;    <span class="function">get</span>: <span class="keyword">function</span>(key, defaultValue) {&#x000A;      <span class="keyword">return</span> <span class="predefined">$window</span>.localStorage[key] || defaultValue;&#x000A;    },&#x000A;    <span class="function">setObject</span>: <span class="keyword">function</span>(key, value) {&#x000A;      <span class="predefined">$window</span>.localStorage[key] = JSON.stringify(value);&#x000A;    },&#x000A;    <span class="function">getObject</span>: <span class="keyword">function</span>(key) {&#x000A;      <span class="keyword">return</span> JSON.parse(<span class="predefined">$window</span>.localStorage[key] || <span class="string"><span class="delimiter">'</span><span class="content">{}</span><span class="delimiter">'</span></span>);&#x000A;    }&#x000A;  }&#x000A;}]);</pre></div>
              </div>
              </div>
              
              <p>And to use this service, just inject the <code>$localstorage</code> service into a controller or run function:</p>
              
              <div><div class="CodeRay">
                <div class="code"><pre>angular.module(<span class="string"><span class="delimiter">'</span><span class="content">app</span><span class="delimiter">'</span></span>, [<span class="string"><span class="delimiter">'</span><span class="content">ionic</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">ionic.utils</span><span class="delimiter">'</span></span>])&#x000A;&#x000A;.run(<span class="keyword">function</span>(<span class="predefined">$localstorage</span>) {&#x000A;&#x000A;  <span class="predefined">$localstorage</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Max</span><span class="delimiter">'</span></span>);&#x000A;  console.log(<span class="predefined">$localstorage</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>));&#x000A;  <span class="predefined">$localstorage</span>.setObject(<span class="string"><span class="delimiter">'</span><span class="content">post</span><span class="delimiter">'</span></span>, {&#x000A;    <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">Thoughts</span><span class="delimiter">'</span></span>,&#x000A;    <span class="key">text</span>: <span class="string"><span class="delimiter">'</span><span class="content">Today was a good day</span><span class="delimiter">'</span></span>&#x000A;  });&#x000A;  &#x000A;  <span class="keyword">var</span> post = <span class="predefined">$localstorage</span>.getObject(<span class="string"><span class="delimiter">'</span><span class="content">post</span><span class="delimiter">'</span></span>);&#x000A;  console.log(post);&#x000A;});</pre></div>
              </div>
              </div>
              
              <h3 id="suggestions">Suggestions</h3>
              
              <p>Since <code>localStorage</code> is a very simple way to store String values for keys, it’s no substitue for a real database. I suggest using Local Storage to persist a small number of larger objects.</p>
              
              <p>And stay tuned for upcoming <a href="http://caniuse.com/indexeddb">IndexedDB support</a> in future mobile browsers, which will provide a more comprehensive local database option.</p>
              
              <p>Try the scratchpad below for a runnable demo of this:</p>
              <section class='scratchpad'>
                <p>Try this tutorial out below in the Scratchpad:</p>
                <div id='scratch'></div>
              </section>
              <footer>
                <h6>further reading</h6>
                <div class='similar-items list'>
                  <div class='item-row'>
                    <div class='similar-item'>
                      <a href='/formulas/backend-data/'>Integrating a Backend Service with AngularJS</a>
                      <p>AngularJS makes interacting with backend data and APIs incredibly easy. Follow this formula to see simple ways to make HTTP calls, and more powerful ways to model data objects on the server.</p>
                    </div>
                  </div>
                </div>
              </footer>
            </article>
          </div>
        </div>
      </div>
      <footer class='main'>
        <span class='attribution'>&copy; 2014 Drifty Co.</span>
        <span class='expand-wrapper'>
          <span class='expand'></span>
        </span>
        <nav id='nav'>
          <a href='https://ionicframework.com' target='_blank'>Ionic</a>
          <a href='https://github.com/driftyco/ionic' target='_blank'>Github</a>
          <a href='mailto:hi@ionicframework.com' target='_blank'>Contact us</a>
          <a href='https://github.com/driftyco/ionic-learn/issues/new' target='_blank'>Suggestions</a>
          <a href='http://ionicons.com/' target='_blank'>Ionicons</a>
          <a href='http://ionicframework.com/jobs/' target='_blank'>Jobs</a>
          <a href='http://forum.ionicframework.com/' target='_blank'>Forum</a>
          <a href='http://ionicframework.com/blog/' target='_blank'>Blog</a>
          <a href='http://drifty.com' target='_blank'>Drifty Co</a>
        </nav>
      </footer>
    </div>
    <div class='get-ionic-wrapper viewed'>
      <a class='get-ionic' href='http://www.ionicframework.com' target='_new'>Get building with Ionic today!</a>
      <a class='close-cta ion-ios7-close-empty' href='#'></a>
    </div>
    <script src='//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js'></script>
    <script src='//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.1.1/js/bootstrap.min.js'></script>
    <script src='//scratch.ionicsdk.com/static/js/embed.js'></script>
      <script>
        $(function() {
          var getTemplate = function(url) {
            return $.ajax({url: location.pathname + '/' + url, dataType: 'text'})
          }
        
          $.when(getTemplate('template.html'), getTemplate('style.css'), getTemplate('script.js')).then(function(html, css, js) {
            var scratch = new IonicScratch({
              el: document.getElementById('scratch'),
              width: '100%',
              height: '600px',
              html: html[0],
              css: css[0],
              js: js[0]
            });
          })
        })
      </script>
    <script src='/js/main.js'></script>
  </body>
</html>
